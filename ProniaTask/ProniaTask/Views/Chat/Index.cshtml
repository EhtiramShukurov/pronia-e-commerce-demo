@{

	Layout = null;
}
@model IEnumerable<AppUser>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Pronia Chat</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
	<link rel="stylesheet" href="https://rawcdn.githack.com/Loopple/loopple-public-assets/ad60f16c8a16d1dcad75e176c00d7f9e69320cd4/argon-dashboard/css/nucleo/css/nucleo.css">
	<link rel="stylesheet" href="~/chatassets/css/theme.css">
	<link rel="stylesheet" href="~/chatassets/css/loopple/loopple.css">
</head>

<body class="g-sidenav-show">
	<div class="main-content" id="panel">
		<nav class="navbar navbar-top navbar-expand navbar-dark bg-primary border-bottom" id="navbarTop">
			<div class="container-fluid">
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
												
					<a asp-action="Index" asp-controller="Home" class="header-logo">
								<img class="mb-3" src="~/assets/images/logo/dark.png" alt="Header Logo" />
							</a>
					<ul class="navbar-nav align-items-center  ml-md-auto ">
						<li class="nav-item d-xl-none">
							<div class="pr-3 sidenav-toggler sidenav-toggler-dark active" data-action="sidenav-pin" data-target="#sidenav-main">
								<div class="sidenav-toggler-inner"> <i class="sidenav-toggler-line"></i> <i class="sidenav-toggler-line"></i> <i class="sidenav-toggler-line"></i> </div>
							</div>
						</li>
						<li class="nav-item d-sm-none"> <a class="nav-link" href="#" data-action="search-show" data-target="#navbar-search-main"> <i class="ni ni-zoom-split-in"></i> </a> </li>
						<li class="nav-item dropdown">
							<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <img alt="flag" src="https://demos.creative-tim.com/argon-dashboard-pro-bs4/assets/img/icons/flags/US.png"> </a>
							<div class="dropdown-menu dropdown-menu-right py-0 overflow-hidden">
								<div class="px-3 pt-3">
									<h6 class="text-sm text-muted m-0">Select Language</h6>
								</div>
								<div class="list-group list-group-flush">
									<a href="#!" class="list-group-item list-group-item-action">
										<div class="row align-items-center">
											<div class="col-auto"> <img alt="flag" src="https://demos.creative-tim.com/argon-dashboard-pro-bs4/assets/img/icons/flags/US.png"> </div>
											<div class="col ml--2">
												<div class="d-flex justify-content-between align-items-center">
													<div>
														<h4 class="mb-0 text-sm">English</h4>
													</div>
												</div>
											</div>
										</div>
										<div class="row align-items-center mt-3">
											<div class="col-auto"> <img alt="flag" src="https://demos.creative-tim.com/argon-dashboard-pro-bs4/assets/img/icons/flags/DE.png"> </div>
											<div class="col ml--2">
												<div class="d-flex justify-content-between align-items-center">
													<div>
														<h4 class="mb-0 text-sm">Germany</h4>
													</div>
												</div>
											</div>
										</div>
									</a>
								</div>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-layer-group"></i> </a>
							<div class="dropdown-menu dropdown-menu-lg dropdown-menu-dark bg-default  dropdown-menu-right ">
								<div class="row shortcuts px-4"> <a href="#!" class="col-4 shortcut-item text-center"> <span class="shortcut-media avatar rounded-circle bg-gradient-red"> <i class="fa fa-calendar"></i> </span> <small class="text-white">Calendar</small> </a> <a href="#!" class="col-4 shortcut-item text-center"> <span class="shortcut-media avatar rounded-circle bg-gradient-orange"> <i class="fa fa-envelope"></i> </span> <small class="text-white">Email</small> </a> <a href="#!" class="col-4 shortcut-item text-center"> <span class="shortcut-media avatar rounded-circle bg-gradient-info"> <i class="fa fa-credit-card"></i> </span> <small class="text-white">Payments</small> </a> <a href="#!" class="col-4 shortcut-item text-center"> <span class="shortcut-media avatar rounded-circle bg-gradient-green"> <i class="fa fa-book"></i> </span> <small class="text-white">Reports</small> </a> <a href="#!" class="col-4 shortcut-item text-center"> <span class="shortcut-media avatar rounded-circle bg-gradient-purple"> <i class="fa fa-map"></i> </span> <small class="text-white">Maps</small> </a> <a href="#!" class="col-4 shortcut-item text-center"> <span class="shortcut-media avatar rounded-circle bg-gradient-yellow"> <i class="fa fa-store"></i> </span> <small class="text-white">Shop</small> </a> </div>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link position-relative" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-bell"></i> <span class="badge badge-danger badge-sm position-absolute top-0 mt-n2 right-1 px-2 py-1">3</span> </a>
							<div class="dropdown-menu dropdown-menu-right dropdown-menu-xl py-0 overflow-hidden">
								<div class="px-3 pt-3">
									<h6 class="text-sm text-muted m-0">You have <span class="text-primary">3</span> new notifications!</h6>
								</div>
								<div class="list-group list-group-flush">
									<a href="#!" class="list-group-item list-group-item-action">
										<div class="row align-items-center">
											<div class="col-auto">
												<!-- Avatar --> <img alt="Image placeholder" src="https://demos.creative-tim.com/argon-dashboard/assets-old/img/theme/team-1.jpg" class="avatar rounded-circle">
											</div>
											<div class="col ml--2">
												<div class="d-flex justify-content-between align-items-center">
													<div>
														<h4 class="mb-0 text-sm">John Snow</h4>
													</div>
													<div class="text-right text-muted"> <small>2 hrs ago</small> </div>
												</div>
												<p class="text-sm mb-0">Let's meet at Starbucks at 11:30. Wdyt?</p>
											</div>
										</div>
									</a> <a href="#!" class="list-group-item list-group-item-action">
										<div class="row align-items-center">
											<div class="col-auto">
												<!-- Avatar --> <img alt="Image placeholder" src="https://demos.creative-tim.com/argon-dashboard/assets-old/img/theme/team-2.jpg" class="avatar rounded-circle">
											</div>
											<div class="col ml--2">
												<div class="d-flex justify-content-between align-items-center">
													<div>
														<h4 class="mb-0 text-sm">Alexa Mira</h4>
													</div>
													<div class="text-right text-muted"> <small>3 hrs ago</small> </div>
												</div>
												<p class="text-sm mb-0">Did you have time to read my E-mail?</p>
											</div>
										</div>
									</a> <a href="#!" class="list-group-item list-group-item-action">
										<div class="row align-items-center">
											<div class="col-auto">
												<!-- Avatar --> <img alt="Image placeholder" src="https://demos.creative-tim.com/argon-dashboard/assets-old/img/theme/team-3.jpg" class="avatar rounded-circle">
											</div>
											<div class="col ml--2">
												<div class="d-flex justify-content-between align-items-center">
													<div>
														<h4 class="mb-0 text-sm">Rala Micharel</h4>
													</div>
													<div class="text-right text-muted"> <small>4 hrs ago</small> </div>
												</div>
												<p class="text-sm mb-0">Just saw your referring program. Can you please give me more details?</p>
											</div>
										</div>
									</a>
								</div>
							</div>
						</li>
					</ul>
					<ul class="navbar-nav align-items-center  ml-auto ml-md-0 ">
						<li class="nav-item dropdown">
							<a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<div class="media align-items-center"> <span class="avatar avatar-sm"> <img alt="Image placeholder" src="https://www.w3schools.com/howto/img_avatar.png"> </span> </div>
							</a>
							<div class="dropdown-menu  dropdown-menu-right ">
								<div class="dropdown-header noti-title">
									<h6 class="text-overflow m-0">Welcome!</h6>
								</div> <a href="#!" class="dropdown-item"> <i class="fa fa-user"></i> <span>My profile</span> </a> <a href="#!" class="dropdown-item"> <i class="fa fa-tools"></i> <span>Settings</span> </a> <a href="#!" class="dropdown-item"> <i class="far fa-calendar"></i> <span>Activity</span> </a> <a href="#!" class="dropdown-item"> <i class="fa fa-phone"></i> <span>Support</span> </a>
								<div class="dropdown-divider"></div> <a asp-controller="Home" asp-action="Index" class="dropdown-item"> <i class="fa fa-sign-out-alt"></i> <span>Back to Menu</span> </a>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<div class="container-fluid pt-3">
			<div class="row removable">
				<div class="col-lg-12 px-sm-0">
					<div class="card shadow-none px-0 bg-transparent mt-0 mb-4">
						<div class="card-body px-0 pb-0">
							<div class="px-0 pb-4">
								<div class="row flex-row">
									<div class="col-lg-3 mb-4">
										<div class="card max-height-vh-70 h-100 overflow-auto overflow-x-hidden mb-5 mb-lg-0" style="max-height: 70vh;">
											<form class="card-header">
												<div class="input-group mb-0">
													<input type="text" placeholder="Search" class="form-control" aria-label="Amount (to the nearest dollar)">
													<div class="input-group-append"> <span class="input-group-text"> <i class="fa fa-search"></i> </span> </div>
												</div>
											</form>
											<div class="card-body p-2">
												@foreach (var item in Model)
												{
												<a href="javascript:;" class="d-block p-2">
													<div class="d-flex p-2">
														<div class="ml-2">
															<div id="@item.UserName" class="justify-content-between align-items-center">
																<h4 class="mb-0 mt-1">@item.UserName <span class="badge badge-success"></span> </h4>
																<p class="status mb-0 text-xs font-weight-bold text-muted">Offline</p>
															</div>
														</div>
													</div>
												</a>
													
												}
											</div>
										</div>
									</div>
									<div class="col-lg-6">
										<div class="card max-height-vh-70" style="max-height: 70vh;">
											<div class="card-header shadow-xl">
												<div class="row">
													<div class="col-md-10">
														<div class="d-flex align-items-center">
															<div class="ms-3">
																<h3 class="mb-0 d-block">Chat</h3> <span class="text-sm text-muted">Software Team</span>
															</div>
														</div>
													</div>
												</div>
											</div>
											<div class="chat-messages card-body overflow-auto overflow-x-hidden">
												<div class="row mt-4">
													<div class="col-md-12 text-center"> <span class="badge text-dark">@DateTime.Now.DayOfWeek.ToString()</span> </div>
												</div>

											</div>
											<div class="card-footer d-block">
												<form class="align-items-center">
													<div class="input-group mb-3">
														<input id="message" type="text" placeholder="Type something" class="form-control" aria-label="Amount (to the nearest dollar)">
														<div class="input-group-append"> <button id="sendMessage" class="input-group-text"> <i class="fa fa-paper-plane"></i> </button> </div>
													</div>
												</form>
											</div>
										</div>
									</div>
									<div class="col-lg-3">
										<div class="card max-height-vh-70 h-100 overflow-auto overflow-x-hidden mb-5 mb-lg-0" style="max-height: 70vh;">
											<div class="card-body p-2">
												<a href="javascript:;" class="d-block p-2"> </a>
												<div class="p-2 text-center">
													<a href="javascript:;" class="d-block p-2"> <img alt="Image" src="https://www.w3schools.com/howto/img_avatar.png" class="avatar avatar-lg shadow mb-0"> </a>
													<div class="ml-2 mt-0 mb-0 text-center">
														<div class="justify-content-between align-items-center">
															<h3 class="mb-0 mt-1">@User.Identity.Name</h3>
															<p class="mb-0 text-sm text-dark font-weight-normal"></p> <a href="" class="text-sm ">View profile</a>
														</div>
													</div>
												</div>
												<hr class="my-3">
												<div class="mx-3">
													<div class="d-flex align-items-center mb-3">
														<i class="fa fa-envelope opacity-7"></i>
														<div class="ml-3">
															<h5 class="mb-0">Email</h5> <span class="text-sm text-primary">@Model.FirstOrDefault(a=>a.UserName == User.Identity.Name)?.Email</span>
														</div>
													</div>
													<div class="d-flex align-items-center">
														<i class="fa fa-phone opacity-7"></i>
														<div class="ml-3">
															<h5 class="mb-0">Phone</h5> <span class="text-sm text-primary">@Model.FirstOrDefault(a=>a.UserName == User.Identity.Name)?.PhoneNumber </span>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div> <!-- Footer -->
		<footer class="mt-5 footer pt-0 px-4">
			<div class="row align-items-center justify-content-lg-between">
				<div class="col-lg-6">
					<div class="copyright text-center  text-lg-left  text-muted"> © 2021 Pronia Inc. </div>
				</div>
				<div class="col-lg-6">
					<ul class="nav nav-footer justify-content-center justify-content-lg-end">
						<li class="nav-item"> <a href="javascript:void(0);" class="nav-link">About us</a> </li>
						<li class="nav-item"> <a href="javascript:;" class="nav-link">Company</a> </li>
						<li class="nav-item"> <a href="javascript:;" class="nav-link">Blog</a> </li>
						<li class="nav-item"> <a href="javascript:;" class="nav-link">Contact</a> </li>
					</ul>
				</div>
			</div>
		</footer>
	</div>
	<script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/jquery.min.js"></script>
	<script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/bootstrap.bundle.min.js"></script>
	<script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/js.cookie.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
	<script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/chart.extension.js"></script>
	<script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/7bb803d2af2ab6d71d429b0cb459c24a4cd0fbb4/argon-dashboard/js/argon.min.js"></script>
	<script src="~/chatassets/js/loopple/loopple.js"></script>
	<script src="~/signalr/dist/browser/signalr.min.js"></script>
	<input type="hidden" value="@User.Identity.Name"/>
	<script>
		var connection = new signalR.HubConnectionBuilder().withUrl("/chatHub").build();

		connection.on("ReceiveMessage", function(user, message) {
			$(".chat-messages").append(`
			<div class="row justify-content-start text-right mb-4">
				<div class="col-auto">
					<div class="card">
						<div class="card-body p-2">
							<p class="mb-1 text-left">${user} </p>

							<p class="mb-1">${message} <br> </p>
							<div class="d-flex align-items-center justify-content-end text-sm opacity-6"> <i class="fa fa-check-double mr-1 text-xs" aria-hidden="true"></i> <small>@string.Format("{0:hh:mm tt}", DateTime.Now)</small> </div>
						</div>
					</div>
				</div>
			</div>`)
            $("#message").val('');
		});
		connection.on("SetOnline", function(name) 
		{
            $('#' + name).find(".status").text("Online");
		})
			connection.start().then(function () {
				document.getElementById("sendMessage").disabled = false;
			}).catch(function (err) {
				return console.error(err.toString());
			});
			$("#sendMessage").click(ev => {

				ev.preventDefault();
                var message = $("#message").val();
				connection.invoke("SendMessage", message).catch(function(err) {
					return console.error(err.toString());
				});
			});


	</script>
</body>